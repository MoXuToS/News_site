<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">

    </head>
    <body>
        <%= data[0].titleArticle %>
        <p>
            <%= data[0].textArticle %>
        </p>
        <div class="form">
            <h2>Изменить статью</h2>
            <form action="http://localhost:3000/admin/editArticle" method="post">
                <label for="titleArticle">Название статьи</label>
                <p>
                    <label for="textArticle">Текст статьи</label>
                    <input type="text" name="desciptionArticle" id="desciptionArticle" value="<%= data[0].descriptionArticle %>"></input>
                </p>
                <button type="submit" id="sendArticle">Редактирвоать статью</button>
                <button type="submit" id="deleteArticle">Удалить статью</button>
                <p><a href="http://localhost:3000/admin/">Вернуться к списку статьей</a></p>
            </form>
        </div>
        <script>
            document.querySelector('sendArticle').onclick=function()
            {
                event.preventDefault();
                let article={
                    'idArticle':location.href.split("/").at(-1),
                    'titleArticle':document.querySelector('#titleArticle').value,
                    'textArticle':document.querySelector('#textArticle').innerHTML,
                    'descriptionArticle':document.querySelector("descriptionArticle").value,
                }
                let promise = fetch('http://localhost:3000/admin/editArticle', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json;charset=utf-8'
                    },
                    body: JSON.stringify(article)
                })
                .then(response => alert("Данные изменены"))
                .catch(response => alert("error" + response));
            };
            document.querySelector("#deleteArticle").onclick = function()
            {
                event.preventDefault();
                let article = {
                    'idArticle':location.href.split("/").at(-1),
                }
                let promise = fetch('http://location:3000/admin/deleteArticle', {
                    method: "POST",
                    headers: {
                        'Content-Type': 'application/json;charset=utf-8'
                    },
                    body: JSON.stringify(article)
                })
                .then(response => document.location = "http://location:3000/admin/")
                .catch((error) => {
                    console.log(error);
                });
            } 
        </script>
    </body>
</html>